# Задача регрессии. Линейная модель. Метод наименьших квадратов. Функция потерь. Метрики оценки регрессии.

Под задачей регрессии понимается определение математической модели (функции регрессии), устанавливающей функциональную связь между зависимой переменной $y$ и группой независимых переменных $X$, взятой с учетом ошибок модели. Регрессия в ML — это задача ML с учителем, целью которой выступает прогнозирование значений непрерывного признака.

---

## Линейная регрессия

Модель регрессии называется линейной, если значение предсказываемого признака $\hat y$ выражается как линейная комбинация признаков $X_1, X_2, \dots, X_n$, взятых с некоторыми коэффициентами:

$$
\hat y = w_1 x_1 + w_2 x_2 + \dots + w_n x_n + b
$$

Где
- $w_i$ — веса (коэффициенты) модели,
- $b$ — смещение (intercept),
- $x_i$ — значения признаков.

---

## Метод наименьших квадратов (МНК)

Метод наименьших квадратов минимизирует сумму квадратов ошибок (отклонений предсказанных регрессионных остатков) — минимизирует функцию потерь в виде

$$
\min_{w,b} \sum_{i=1}^{m} (w^T x_i + b - y_i)^2
$$

где
- $m$ — число обучающих примеров,
- $y_i$ — истинное значение целевой переменной для $i$-го примера,
- $w^T x_i + b$ — предсказанное значение модели.

---

## Функция потерь

Функция потерь — мера количества ошибок, которые линейная регрессия делает на наборе данных; чем меньше функция потерь, тем точнее модель. В ML-практике обычно используют несколько метрик:

### Коэффициент детерминации $R^2$
Доля дисперсии зависимой переменной, объясненная моделью:
$$
R^2 = 1 - \frac{\sum_{i=1}^m (y_i - \hat y_i)^2}{\sum_{i=1}^m (y_i - \bar y)^2}
$$
где $\bar y$ — среднее истинных значений.

### MAE (Mean Absolute Error)
Средняя абсолютная ошибка:
$$
\mathrm{MAE} = \frac{1}{m} \sum_{i=1}^m \bigl|y_i - \hat y_i\bigr|
$$

### MSE (Mean Squared Error)
Среднеквадратичная ошибка:
$$
\mathrm{MSE} = \frac{1}{m} \sum_{i=1}^m (y_i - \hat y_i)^2
$$

### RMSE (Root Mean Squared Error)
Корень из MSE:
$$
\mathrm{RMSE} = \sqrt{\mathrm{MSE}} = \sqrt{\frac{1}{m} \sum_{i=1}^m (y_i - \hat y_i)^2}
$$

### MAPE (Mean Absolute Percentage Error)
Средняя абсолютная ошибка в процентах:
$$
\mathrm{MAPE} = \frac{100\%}{m} \sum_{i=1}^m \left|\frac{y_i - \hat y_i}{y_i}\right|
$$

> **MAE, MSE, RMSE, MAPE** — это функции потерь, поэтому их обычно минимизируют во время обучения модели для достижения максимальной точности предсказаний.
